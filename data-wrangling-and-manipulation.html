<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Data wrangling and manipulation | Module 1</title>
  <meta name="description" content="Chapter 2 Data wrangling and manipulation | Module 1" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Data wrangling and manipulation | Module 1" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Data wrangling and manipulation | Module 1" />
  
  
  

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-and-rstudio-1.html"/>
<link rel="next" href="ethical-data-practice.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSCI 220: Quantitative Biology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Nau mai, haere mai. Welcome to BIOSCI 220!</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html"><i class="fa fa-check"></i>Key Information</a>
<ul>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#course-outline"><i class="fa fa-check"></i>Course outline</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#r-and-rstudio"><i class="fa fa-check"></i><code>R</code> and <code>RStudio</code></a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#your-teaching-team"><i class="fa fa-check"></i>Your teaching team</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="key-information.html"><a href="key-information.html#assessment"><i class="fa fa-check"></i>Assessment</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-and-rstudio-1.html"><a href="r-and-rstudio-1.html"><i class="fa fa-check"></i><b>1</b> <code>R</code> and <code>RStudio</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-and-rstudio-1.html"><a href="r-and-rstudio-1.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are <code>R</code> and <code>RStudio</code>?</a></li>
<li class="chapter" data-level="1.2" data-path="r-and-rstudio-1.html"><a href="r-and-rstudio-1.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="r-and-rstudio-1.html"><a href="r-and-rstudio-1.html#getting-started-with-r"><i class="fa fa-check"></i><b>1.3</b> Getting started with <code>R</code></a></li>
<li class="chapter" data-level="1.4" data-path="r-and-rstudio-1.html"><a href="r-and-rstudio-1.html#dealing-with-data"><i class="fa fa-check"></i><b>1.4</b> Dealing with data</a></li>
<li class="chapter" data-level="1.5" data-path="r-and-rstudio-1.html"><a href="r-and-rstudio-1.html#error-handling-and-debugging"><i class="fa fa-check"></i><b>1.5</b> Error handling and debugging</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-wrangling-and-manipulation.html"><a href="data-wrangling-and-manipulation.html"><i class="fa fa-check"></i><b>2</b> Data wrangling and manipulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-wrangling-and-manipulation.html"><a href="data-wrangling-and-manipulation.html#exploratory-data-analysis-and-data-wrangling-in-the-tidyverse"><i class="fa fa-check"></i><b>2.1</b> Exploratory data analysis and data wrangling in the Tidyverse</a></li>
<li class="chapter" data-level="2.2" data-path="data-wrangling-and-manipulation.html"><a href="data-wrangling-and-manipulation.html#data-visualization"><i class="fa fa-check"></i><b>2.2</b> Data Visualization</a></li>
<li class="chapter" data-level="2.3" data-path="data-wrangling-and-manipulation.html"><a href="data-wrangling-and-manipulation.html#plotting-using-ggplot2"><i class="fa fa-check"></i><b>2.3</b> Plotting using <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.4" data-path="data-wrangling-and-manipulation.html"><a href="data-wrangling-and-manipulation.html#bringing-things-together"><i class="fa fa-check"></i><b>2.4</b> Bringing things together</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ethical-data-practice.html"><a href="ethical-data-practice.html"><i class="fa fa-check"></i><b>3</b> Ethical data practice</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ethical-data-practice.html"><a href="ethical-data-practice.html#accuracy-and-honesty"><i class="fa fa-check"></i><b>3.1</b> Accuracy and Honesty</a></li>
<li class="chapter" data-level="3.2" data-path="ethical-data-practice.html"><a href="ethical-data-practice.html#respectful-handling-of-data"><i class="fa fa-check"></i><b>3.2</b> Respectful Handling of Data</a></li>
<li class="chapter" data-level="3.3" data-path="ethical-data-practice.html"><a href="ethical-data-practice.html#awareness-of-consequences"><i class="fa fa-check"></i><b>3.3</b> Awareness of Consequences</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>4</b> Introduction to the design and analysis of experiments</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#introduction-to-experiments"><i class="fa fa-check"></i><b>4.1</b> Introduction to experiments</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#the-three-main-principles-of-experimental-design"><i class="fa fa-check"></i><b>4.2</b> The three (main) principles of experimental design</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-the-design-and-analysis-of-experiments.html"><a href="introduction-to-the-design-and-analysis-of-experiments.html#experimental-designs"><i class="fa fa-check"></i><b>4.3</b> Experimental designs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Introduction to Hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#randomization-tests"><i class="fa fa-check"></i><b>5.1</b> Randomization tests</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#what-is-a-p-value"><i class="fa fa-check"></i><b>5.2</b> What is a <em>p-value</em>?</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-vocabulary-of-hypothesis-testing"><i class="fa fa-check"></i><b>5.3</b> The Vocabulary of hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Hypothesis testing and introduction to linear regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#hypothesis-testing"><i class="fa fa-check"></i><b>6.1</b> Hypothesis testing</a></li>
<li class="chapter" data-level="6.2" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#model-assumptions"><i class="fa fa-check"></i><b>6.2</b> Model assumptions</a></li>
<li class="chapter" data-level="6.3" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#model-diagnostic-plots"><i class="fa fa-check"></i><b>6.3</b> Model diagnostic plots</a></li>
<li class="chapter" data-level="6.4" data-path="hypothesis-testing-and-introduction-to-linear-regression.html"><a href="hypothesis-testing-and-introduction-to-linear-regression.html#other-resources-optional-but-recommended"><i class="fa fa-check"></i><b>6.4</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>7</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-inference.html"><a href="statistical-inference.html#linear-regression"><i class="fa fa-check"></i><b>7.1</b> Linear Regression</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-inference.html"><a href="statistical-inference.html#model-comparison-selection-and-checking-again"><i class="fa fa-check"></i><b>7.2</b> Model comparison, selection, and checking (again)</a></li>
<li class="chapter" data-level="7.3" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-and-point-predictions"><i class="fa fa-check"></i><b>7.3</b> Confidence intervals and point predictions</a></li>
<li class="chapter" data-level="7.4" data-path="statistical-inference.html"><a href="statistical-inference.html#tldr-lm"><i class="fa fa-check"></i><b>7.4</b> TL;DR <code>lm()</code></a></li>
<li class="chapter" data-level="7.5" data-path="statistical-inference.html"><a href="statistical-inference.html#other-resources-optional-but-recommended-1"><i class="fa fa-check"></i><b>7.5</b> Other resources: optional but recommended</a></li>
<li class="chapter" data-level="7.6" data-path="statistical-inference.html"><a href="statistical-inference.html#beyond-linear-models-to-generalised-linear-models-glms-not-examinable"><i class="fa fa-check"></i><b>7.6</b> Beyond Linear Models to Generalised Linear Models (GLMs) (<em>not examinable</em>)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html"><i class="fa fa-check"></i><b>8</b> Multivariate Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#what-is-multivariate-data"><i class="fa fa-check"></i><b>8.1</b> What is multivariate data?</a></li>
<li class="chapter" data-level="8.2" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#dimension-reduction"><i class="fa fa-check"></i><b>8.2</b> Dimension reduction</a></li>
<li class="chapter" data-level="8.3" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#distance-matrices-and-measures"><i class="fa fa-check"></i><b>8.3</b> Distance matrices and measures</a></li>
<li class="chapter" data-level="8.4" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#why-is-nmds-used-frequently-in-biology"><i class="fa fa-check"></i><b>8.4</b> Why is nMDS used frequently in biology?</a></li>
<li class="chapter" data-level="8.5" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#steps-to-nmds"><i class="fa fa-check"></i><b>8.5</b> Steps to nMDS</a></li>
<li class="chapter" data-level="8.6" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#nmds-in-r-using-metamds-on-the-palmerpenguins-data-set"><i class="fa fa-check"></i><b>8.6</b> nMDS in <code>R</code> using <code>metaMDS()</code> on the <code>palmerpenguins</code> data set</a></li>
<li class="chapter" data-level="8.7" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#diagnostic-plots-for-nmds"><i class="fa fa-check"></i><b>8.7</b> Diagnostic plots for nMDS</a></li>
<li class="chapter" data-level="8.8" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#how-to-interpret-an-nmds-plot-and-what-to-report"><i class="fa fa-check"></i><b>8.8</b> How to interpret an nMDS plot and what to report</a></li>
<li class="chapter" data-level="8.9" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#nmds-in-r-using-metamds-with-community-structure-data"><i class="fa fa-check"></i><b>8.9</b> nMDS in <code>R</code> using <code>metaMDS()</code> with community structure data</a></li>
<li class="chapter" data-level="8.10" data-path="multivariate-data-analysis.html"><a href="multivariate-data-analysis.html#other-resources-optional-but-recommended-2"><i class="fa fa-check"></i><b>8.10</b> Other resources: optional but recommended</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://canvas.auckland.ac.nz/courses/104039">CANVAS</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Module 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling-and-manipulation" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Data wrangling and manipulation<a href="data-wrangling-and-manipulation.html#data-wrangling-and-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="alert alert-success" role="alert">
<center>
<img src="https://github.com/BIOSCI220/hoiho/blob/main/hoiho_hex.png?raw=true" style="width:10.0%" />
</center>
<p><strong>Learning objectives</strong></p>
<ul>
<li>
Import data into R from a <code>.csv</code> file using 1) functions and 2) via the menu
</li>
<li>
Apply the principles of tidy data using the <code>tidyverse</code> in <code>R</code>
</li>
<li>
Carry out and interpret the outputs of basic exploratory data analysis using in-built <code>R</code> functions
</li>
<li>
Carry out basic data wrangling techniques in <code>R</code> (e.g., reshaping data, creating new variables, and aggregating information using functions such as the <code>tidyverse</code> functions <code>mutate()</code>, <code>group_by()</code>, and <code>summarize()</code>).
</li>
<li>
Implement <code>tidyverse</code> pipelines using the <code>%&gt;%</code> (pipe) operator
</li>
<li>
Create appropriate and communicate informative data visualizations using <code>R</code>
</li>
<li>
Map the appropriate data structure to a <code>ggplot2</code> aesthetic
</li>
<li>
Identify the mapping of a variable given a plot
</li>
<li>
Discuss and critique data visualizations
</li>
</ul>
</div>
<div id="exploratory-data-analysis-and-data-wrangling-in-the-tidyverse" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Exploratory data analysis and data wrangling in the Tidyverse<a href="data-wrangling-and-manipulation.html#exploratory-data-analysis-and-data-wrangling-in-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this, and most other sections, we will be using the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>, which is a collection of <code>R</code> packages that all share underlying design philosophy, grammar, and data structures. They are specifically designed to make data wrangling, manipulation, visualization, and analysis simpler.</p>
<p>To install <strong>all</strong> the packages that belong to the <code>tidyverse</code> run</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-wrangling-and-manipulation.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## request (download) the tidyverse packages from the centralised library</span></span>
<span id="cb18-2"><a href="data-wrangling-and-manipulation.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>To tell your computer to access the <code>tidyverse</code> functionality in your session run (<strong>Note</strong> you’ll have to do this each time you start up an <code>R</code> session):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-wrangling-and-manipulation.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the tidyverse packages from our local library</span></span>
<span id="cb19-2"><a href="data-wrangling-and-manipulation.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Do this every time you start a new session</span></span>
<span id="cb19-3"><a href="data-wrangling-and-manipulation.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">## and want to use the tidyverse! </span></span>
<span id="cb19-4"><a href="data-wrangling-and-manipulation.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="the-pipe-operator" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> The pipe operator<a href="data-wrangling-and-manipulation.html#the-pipe-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A nifty <code>tidyverse</code> tool is called the pipe operator <code>%&gt;%</code>. The pipe operator allows us to combine multiple operations in <code>R</code> into a single sequential chain of actions.</p>
<p>Say you would like to perform a hypothetical sequence of operations on a hypothetical data frame <code>x</code> using hypothetical functions <code>f()</code>, <code>g()</code>, and <code>h()</code>:</p>
<p>This is where the pipe operator <code>%&gt;%</code> comes in handy. <code>%&gt;%</code> takes the output of one function and then “pipes” it to be the input of the next function. Furthermore, a helpful trick is to read <code>%&gt;%</code> as “then” or “and then.” For example, you can obtain the same output as the hypothetical sequence of functions as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-wrangling-and-manipulation.html#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="data-wrangling-and-manipulation.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="data-wrangling-and-manipulation.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">g</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="data-wrangling-and-manipulation.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">h</span>()</span></code></pre></div>
<p>You would read this sequence as:</p>
<ul>
<li>Take <code>x</code> then</li>
<li>Use this output as the input to the next function <code>f()</code> then</li>
<li>Use this output as the input to the next function <code>g()</code> then</li>
<li>Use this output as the input to the next function <code>h()</code>.</li>
</ul>
<p>Let’s first read in the P<span class="math inline">\(\overline{\text{a}}\)</span>ua data we looked at in the previous chapter:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-wrangling-and-manipulation.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-2"><a href="data-wrangling-and-manipulation.html#cb21-2" aria-hidden="true" tabindex="-1"></a>paua <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/STATS-UOA/databunker/master/data/paua.csv&quot;</span>)</span></code></pre></div>
<div class="alert alert-warning">
<p><strong>TASK</strong> Revisit the <a href="r-and-rstudio-1.html#dealing-with-data">Dealing with data</a> section in the previous chapter and make sure to practice reading the file into <code>R</code> using the different ways given. Make sure to restart <code>R</code> (i.e., close it down completely and open up a fresh clean workspace) each time.</p>
</div>
<p>Using a <code>tidyverse</code> pipeline we can calculate the mean <strong>Age</strong> of each <strong>Species</strong> in the <code>paua</code> dataset via</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-wrangling-and-manipulation.html#cb22-1" aria-hidden="true" tabindex="-1"></a>paua <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="data-wrangling-and-manipulation.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="data-wrangling-and-manipulation.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(Age))</span>
<span id="cb22-4"><a href="data-wrangling-and-manipulation.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 × 2</span></span>
<span id="cb22-5"><a href="data-wrangling-and-manipulation.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   Species            mean_age</span></span>
<span id="cb22-6"><a href="data-wrangling-and-manipulation.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                 &lt;dbl&gt;</span></span>
<span id="cb22-7"><a href="data-wrangling-and-manipulation.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Haliotis australis     7.55</span></span>
<span id="cb22-8"><a href="data-wrangling-and-manipulation.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Haliotis iris          4.40</span></span></code></pre></div>
<p>You would read the sequence above as</p>
<ul>
<li>Take the <code>paua</code> data.frame then</li>
<li>Use this and apply the <code>group_by()</code> function to group by <code>Species</code></li>
<li>Use this output and apply the <code>summarize()</code> function to calculate the mean (using (<code>mean()</code>) <code>Age</code> of each group (<code>Species</code>), calling the resulting number <code>mean_age</code></li>
</ul>
</div>
<div id="tidy-data" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> <code>tidy</code> data<a href="data-wrangling-and-manipulation.html#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
“Tidy datasets are all alike, but every messy dataset is messy in its own way.”
<footer>
— Hadley Wickham
</footer>
</blockquote>
<p>There are three interrelated rules which make a dataset <code>tidy</code>:</p>
<ol style="list-style-type: decimal">
<li>Each variable must have its own column</li>
<li>Each observation must have its own row</li>
<li>Each value must have its own cell</li>
</ol>
<p align="center">
<img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_1.jpg" style="width:70.0%" />
</p>
<p align="center">
Illustration from the Openscapes blog <a href="https://www.openscapes.org/blog/2020/10/12/tidy-data/">Tidy Data for reproducibility, efficiency, and collaboration</a> by Julia Lowndes and Allison Horst
</p>
<p>Why ensure that your data is <code>tidy</code>? 1) <strong>Consistency:</strong> using a consistent format aids learning and reproducibility, and 2) <strong>simplicity:</strong> it’s a format that is well understood by <code>R</code>!</p>
<blockquote>
“Tidy datasets are easy to manipulate, model and visualize, and have a specific structure: each variable is a column, each observation is a row, and each type of observational unit is a table. This framework makes it easy to tidy messy datasets because only a small set of tools are needed to deal with a wide range of un-tidy datasets.”
<footer>
— Hadley Wickham, Tidy Data
</footer>
</blockquote>
</div>
<div id="introuducing-the-palmer-penguins" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Introuducing the <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081">Palmer penguins</a><a href="data-wrangling-and-manipulation.html#introuducing-the-palmer-penguins" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-wrangling-and-manipulation.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins) <span class="do">## this package contains some nice penguin data</span></span>
<span id="cb23-2"><a href="data-wrangling-and-manipulation.html#cb23-2" aria-hidden="true" tabindex="-1"></a>penguins</span>
<span id="cb23-3"><a href="data-wrangling-and-manipulation.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 344 × 8</span></span>
<span id="cb23-4"><a href="data-wrangling-and-manipulation.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g</span></span>
<span id="cb23-5"><a href="data-wrangling-and-manipulation.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb23-6"><a href="data-wrangling-and-manipulation.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Adelie  Torgersen           39.1          18.7               181        3750</span></span>
<span id="cb23-7"><a href="data-wrangling-and-manipulation.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Adelie  Torgersen           39.5          17.4               186        3800</span></span>
<span id="cb23-8"><a href="data-wrangling-and-manipulation.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Adelie  Torgersen           40.3          18                 195        3250</span></span>
<span id="cb23-9"><a href="data-wrangling-and-manipulation.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Adelie  Torgersen           NA            NA                  NA          NA</span></span>
<span id="cb23-10"><a href="data-wrangling-and-manipulation.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Adelie  Torgersen           36.7          19.3               193        3450</span></span>
<span id="cb23-11"><a href="data-wrangling-and-manipulation.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Adelie  Torgersen           39.3          20.6               190        3650</span></span>
<span id="cb23-12"><a href="data-wrangling-and-manipulation.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Adelie  Torgersen           38.9          17.8               181        3625</span></span>
<span id="cb23-13"><a href="data-wrangling-and-manipulation.html#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Adelie  Torgersen           39.2          19.6               195        4675</span></span>
<span id="cb23-14"><a href="data-wrangling-and-manipulation.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Adelie  Torgersen           34.1          18.1               193        3475</span></span>
<span id="cb23-15"><a href="data-wrangling-and-manipulation.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Adelie  Torgersen           42            20.2               190        4250</span></span>
<span id="cb23-16"><a href="data-wrangling-and-manipulation.html#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 334 more rows</span></span>
<span id="cb23-17"><a href="data-wrangling-and-manipulation.html#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</span></span></code></pre></div>
<p>So, what does this show us?</p>
<ul>
<li><code>A tibble: 344 x 8</code>: A <code>tibble</code> is a specific kind of data frame in <code>R</code>. The <code>penguin</code> dataset has
<ul>
<li><code>344</code> rows (i.e., 344 different observations). Here, each observation corresponds to a penguin.</li>
<li><code>8</code> columns corresponding to 3 variables describing each observation.</li>
<li><code>species</code>, <code>island</code>, <code>bill_length_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>body_mass_g</code>, <code>sex</code>, and <code>year</code> are the different variables of this dataset.</li>
</ul></li>
<li>We then have a preview of the first 10 rows of observations corresponding to the first 10 penguins. ``<code>... with 334 more rows</code> indicates there are 334 more rows to see, but these have not been printed (likely as it would clog our screen)</li>
</ul>
<p>To learn more about the penguins read the <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081">paper that talks all about the data collection.</a></p>
</div>
<div id="common-dataframe-manipulations-in-the-tidyverse-using-dplyr-and-tidyr" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Common dataframe manipulations in the <code>tidyverse</code>, using <code>dplyr</code> and <code>tidyr</code><a href="data-wrangling-and-manipulation.html#common-dataframe-manipulations-in-the-tidyverse-using-dplyr-and-tidyr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Even from these first few rows of data we can see that there are some <code>NA</code> values. Let’s count the number of <code>NA</code>s. Remember the <code>%&gt;%</code> operator? Here we’re going to be introduced to a few new things</p>
<ul>
<li>the <code>apply()</code> function,</li>
<li>the <code>is.na()</code> function, and</li>
<li>how <code>R</code> deals with <code>logical</code> values!</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data-wrangling-and-manipulation.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-2"><a href="data-wrangling-and-manipulation.html#cb24-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="data-wrangling-and-manipulation.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(.,<span class="dv">2</span>,is.na) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="data-wrangling-and-manipulation.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(.,<span class="dv">2</span>,sum)</span>
<span id="cb24-5"><a href="data-wrangling-and-manipulation.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="do">##           species            island    bill_length_mm     bill_depth_mm </span></span>
<span id="cb24-6"><a href="data-wrangling-and-manipulation.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                 0                 0                 2                 2 </span></span>
<span id="cb24-7"><a href="data-wrangling-and-manipulation.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="do">## flipper_length_mm       body_mass_g               sex              year </span></span>
<span id="cb24-8"><a href="data-wrangling-and-manipulation.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                 2                 2                11                 0</span></span></code></pre></div>
<p>There’s lot going on in that code! Let’s break it down</p>
<ul>
<li>Take <code>penguins</code> then</li>
<li>Use <code>penguins</code> as an input to the <code>apply()</code> function (this is specified as the first argument using the <code>.</code>)
<ul>
<li>Now the <code>apply()</code> function takes 3 arguments:
<ol style="list-style-type: decimal">
<li>the data object you want it to <em>apply</em> something to (in our case <code>penguins</code>)</li>
<li>the margin you want to <em>apply</em> that something to; 1 stands for rows and 2 stands for columns, and</li>
<li>the function you want it to apply (in our case <code>is.na()</code>).</li>
</ol></li>
<li>So the second line of code is asking <code>R</code> to <em>apply</em> the <code>is.na()</code> function over the columns of <code>penguins</code>
<ul>
<li><code>is.na()</code> asks for each value it’s fed is it an <code>NA</code> value; it returns a <code>TRUE</code> if so and a <code>FALSE</code> otherwise</li>
</ul></li>
</ul></li>
<li>The output from the first <code>apply()</code> is then fed to the second <code>apply()</code> (using the <code>.</code>). The <code>sum()</code> function then add them up!
<ul>
<li><code>R</code> treats a <code>TRUE</code> as a 1 and a <code>FALSE</code> as a 0.</li>
</ul></li>
</ul>
<p>So how many <code>NA</code>s do you think there are!</p>
<p>Doesn’t help much. To</p>
<p>Now we know there are <code>NA</code> values throughout the data let’s remove then and create a new <code>NA</code> free version called <code>penguins_nafree</code>. There is a really handy <code>tidyverse</code> (<code>dplyr</code>) function for this!</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-wrangling-and-manipulation.html#cb25-1" aria-hidden="true" tabindex="-1"></a>penguins_nafree <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb25-2"><a href="data-wrangling-and-manipulation.html#cb25-2" aria-hidden="true" tabindex="-1"></a>penguins_nafree</span>
<span id="cb25-3"><a href="data-wrangling-and-manipulation.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 333 × 8</span></span>
<span id="cb25-4"><a href="data-wrangling-and-manipulation.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g</span></span>
<span id="cb25-5"><a href="data-wrangling-and-manipulation.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb25-6"><a href="data-wrangling-and-manipulation.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Adelie  Torgersen           39.1          18.7               181        3750</span></span>
<span id="cb25-7"><a href="data-wrangling-and-manipulation.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Adelie  Torgersen           39.5          17.4               186        3800</span></span>
<span id="cb25-8"><a href="data-wrangling-and-manipulation.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Adelie  Torgersen           40.3          18                 195        3250</span></span>
<span id="cb25-9"><a href="data-wrangling-and-manipulation.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Adelie  Torgersen           36.7          19.3               193        3450</span></span>
<span id="cb25-10"><a href="data-wrangling-and-manipulation.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Adelie  Torgersen           39.3          20.6               190        3650</span></span>
<span id="cb25-11"><a href="data-wrangling-and-manipulation.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Adelie  Torgersen           38.9          17.8               181        3625</span></span>
<span id="cb25-12"><a href="data-wrangling-and-manipulation.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Adelie  Torgersen           39.2          19.6               195        4675</span></span>
<span id="cb25-13"><a href="data-wrangling-and-manipulation.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Adelie  Torgersen           41.1          17.6               182        3200</span></span>
<span id="cb25-14"><a href="data-wrangling-and-manipulation.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Adelie  Torgersen           38.6          21.2               191        3800</span></span>
<span id="cb25-15"><a href="data-wrangling-and-manipulation.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Adelie  Torgersen           34.6          21.1               198        4400</span></span>
<span id="cb25-16"><a href="data-wrangling-and-manipulation.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 323 more rows</span></span>
<span id="cb25-17"><a href="data-wrangling-and-manipulation.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</span></span></code></pre></div>
<p>Below are some other useful manipulation functions; have a look at the outputs and run them yourselves and see if you can work out what they’re doing.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data-wrangling-and-manipulation.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(penguins_nafree, island <span class="sc">==</span> <span class="st">&quot;Torgersen&quot;</span> )</span>
<span id="cb26-2"><a href="data-wrangling-and-manipulation.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 47 × 8</span></span>
<span id="cb26-3"><a href="data-wrangling-and-manipulation.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g</span></span>
<span id="cb26-4"><a href="data-wrangling-and-manipulation.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb26-5"><a href="data-wrangling-and-manipulation.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Adelie  Torgersen           39.1          18.7               181        3750</span></span>
<span id="cb26-6"><a href="data-wrangling-and-manipulation.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Adelie  Torgersen           39.5          17.4               186        3800</span></span>
<span id="cb26-7"><a href="data-wrangling-and-manipulation.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Adelie  Torgersen           40.3          18                 195        3250</span></span>
<span id="cb26-8"><a href="data-wrangling-and-manipulation.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Adelie  Torgersen           36.7          19.3               193        3450</span></span>
<span id="cb26-9"><a href="data-wrangling-and-manipulation.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Adelie  Torgersen           39.3          20.6               190        3650</span></span>
<span id="cb26-10"><a href="data-wrangling-and-manipulation.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Adelie  Torgersen           38.9          17.8               181        3625</span></span>
<span id="cb26-11"><a href="data-wrangling-and-manipulation.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Adelie  Torgersen           39.2          19.6               195        4675</span></span>
<span id="cb26-12"><a href="data-wrangling-and-manipulation.html#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Adelie  Torgersen           41.1          17.6               182        3200</span></span>
<span id="cb26-13"><a href="data-wrangling-and-manipulation.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Adelie  Torgersen           38.6          21.2               191        3800</span></span>
<span id="cb26-14"><a href="data-wrangling-and-manipulation.html#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Adelie  Torgersen           34.6          21.1               198        4400</span></span>
<span id="cb26-15"><a href="data-wrangling-and-manipulation.html#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 37 more rows</span></span>
<span id="cb26-16"><a href="data-wrangling-and-manipulation.html#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</span></span>
<span id="cb26-17"><a href="data-wrangling-and-manipulation.html#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(penguins_nafree, <span class="at">average_bill_length =</span> <span class="fu">mean</span>(bill_length_mm))</span>
<span id="cb26-18"><a href="data-wrangling-and-manipulation.html#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 1 × 1</span></span>
<span id="cb26-19"><a href="data-wrangling-and-manipulation.html#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   average_bill_length</span></span>
<span id="cb26-20"><a href="data-wrangling-and-manipulation.html#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="do">##                 &lt;dbl&gt;</span></span>
<span id="cb26-21"><a href="data-wrangling-and-manipulation.html#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 1                44.0</span></span>
<span id="cb26-22"><a href="data-wrangling-and-manipulation.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(penguins_nafree, species)</span>
<span id="cb26-23"><a href="data-wrangling-and-manipulation.html#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 333 × 8</span></span>
<span id="cb26-24"><a href="data-wrangling-and-manipulation.html#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="do">## # Groups:   species [3]</span></span>
<span id="cb26-25"><a href="data-wrangling-and-manipulation.html#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="do">##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g</span></span>
<span id="cb26-26"><a href="data-wrangling-and-manipulation.html#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb26-27"><a href="data-wrangling-and-manipulation.html#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Adelie  Torgersen           39.1          18.7               181        3750</span></span>
<span id="cb26-28"><a href="data-wrangling-and-manipulation.html#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Adelie  Torgersen           39.5          17.4               186        3800</span></span>
<span id="cb26-29"><a href="data-wrangling-and-manipulation.html#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Adelie  Torgersen           40.3          18                 195        3250</span></span>
<span id="cb26-30"><a href="data-wrangling-and-manipulation.html#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Adelie  Torgersen           36.7          19.3               193        3450</span></span>
<span id="cb26-31"><a href="data-wrangling-and-manipulation.html#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Adelie  Torgersen           39.3          20.6               190        3650</span></span>
<span id="cb26-32"><a href="data-wrangling-and-manipulation.html#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Adelie  Torgersen           38.9          17.8               181        3625</span></span>
<span id="cb26-33"><a href="data-wrangling-and-manipulation.html#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Adelie  Torgersen           39.2          19.6               195        4675</span></span>
<span id="cb26-34"><a href="data-wrangling-and-manipulation.html#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Adelie  Torgersen           41.1          17.6               182        3200</span></span>
<span id="cb26-35"><a href="data-wrangling-and-manipulation.html#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Adelie  Torgersen           38.6          21.2               191        3800</span></span>
<span id="cb26-36"><a href="data-wrangling-and-manipulation.html#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Adelie  Torgersen           34.6          21.1               198        4400</span></span>
<span id="cb26-37"><a href="data-wrangling-and-manipulation.html#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 323 more rows</span></span>
<span id="cb26-38"><a href="data-wrangling-and-manipulation.html#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</span></span></code></pre></div>
<p>Often we want to summarise variables by different groups (factors). Below we</p>
<ul>
<li>Take the <code>penguins_nafree</code> data then</li>
<li>Use this and apply the <code>group_by()</code> function to group by <code>species</code></li>
<li>Use this output and apply the <code>summarize()</code> function to calculate the mean (using (<code>mean()</code>) bill length (<code>bill_length_mm</code>) of each group (<code>species</code>), calling the resulting number <code>average_bill_length</code></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-wrangling-and-manipulation.html#cb27-1" aria-hidden="true" tabindex="-1"></a>penguins_nafree <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="data-wrangling-and-manipulation.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="data-wrangling-and-manipulation.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average_bill_length =</span> <span class="fu">mean</span>(bill_length_mm))</span>
<span id="cb27-4"><a href="data-wrangling-and-manipulation.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb27-5"><a href="data-wrangling-and-manipulation.html#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   species   average_bill_length</span></span>
<span id="cb27-6"><a href="data-wrangling-and-manipulation.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;fct&gt;                   &lt;dbl&gt;</span></span>
<span id="cb27-7"><a href="data-wrangling-and-manipulation.html#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Adelie                   38.8</span></span>
<span id="cb27-8"><a href="data-wrangling-and-manipulation.html#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Chinstrap                48.8</span></span>
<span id="cb27-9"><a href="data-wrangling-and-manipulation.html#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Gentoo                   47.6</span></span></code></pre></div>
<p>We can also group by multiple factors, for example,</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data-wrangling-and-manipulation.html#cb28-1" aria-hidden="true" tabindex="-1"></a>penguins_nafree <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="data-wrangling-and-manipulation.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(island,species) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="data-wrangling-and-manipulation.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average_bill_length =</span> <span class="fu">mean</span>(bill_length_mm))</span>
<span id="cb28-4"><a href="data-wrangling-and-manipulation.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb28-5"><a href="data-wrangling-and-manipulation.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # Groups:   island [3]</span></span>
<span id="cb28-6"><a href="data-wrangling-and-manipulation.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   island    species   average_bill_length</span></span>
<span id="cb28-7"><a href="data-wrangling-and-manipulation.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;fct&gt;     &lt;fct&gt;                   &lt;dbl&gt;</span></span>
<span id="cb28-8"><a href="data-wrangling-and-manipulation.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Biscoe    Adelie                   39.0</span></span>
<span id="cb28-9"><a href="data-wrangling-and-manipulation.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Biscoe    Gentoo                   47.6</span></span>
<span id="cb28-10"><a href="data-wrangling-and-manipulation.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Dream     Adelie                   38.5</span></span>
<span id="cb28-11"><a href="data-wrangling-and-manipulation.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Dream     Chinstrap                48.8</span></span>
<span id="cb28-12"><a href="data-wrangling-and-manipulation.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 Torgersen Adelie                   39.0</span></span></code></pre></div>
<p><strong>What about getting more complicated?</strong></p>
<p>I suggest you run the code below one pipe at a time to work out what each function is doing and data it is acting on.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data-wrangling-and-manipulation.html#cb29-1" aria-hidden="true" tabindex="-1"></a>penguins_nafree <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="data-wrangling-and-manipulation.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(., sex <span class="sc">!=</span> <span class="st">&quot;male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="data-wrangling-and-manipulation.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;island&quot;</span>, <span class="st">&quot;body_mass_g&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="data-wrangling-and-manipulation.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, island) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="data-wrangling-and-manipulation.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_mass_g =</span> <span class="fu">sum</span>(body_mass_g)) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="data-wrangling-and-manipulation.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="fu">c</span>(island), <span class="at">values_from =</span> total_mass_g)</span>
<span id="cb29-7"><a href="data-wrangling-and-manipulation.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 3 × 4</span></span>
<span id="cb29-8"><a href="data-wrangling-and-manipulation.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="do">## # Groups:   species [3]</span></span>
<span id="cb29-9"><a href="data-wrangling-and-manipulation.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   species   Biscoe  Dream Torgersen</span></span>
<span id="cb29-10"><a href="data-wrangling-and-manipulation.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;fct&gt;      &lt;int&gt;  &lt;int&gt;     &lt;int&gt;</span></span>
<span id="cb29-11"><a href="data-wrangling-and-manipulation.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Adelie     74125  90300     81500</span></span>
<span id="cb29-12"><a href="data-wrangling-and-manipulation.html#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Chinstrap     NA 119925        NA</span></span>
<span id="cb29-13"><a href="data-wrangling-and-manipulation.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Gentoo    271425     NA        NA</span></span></code></pre></div>
</div>
</div>
<div id="data-visualization" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Data Visualization<a href="data-wrangling-and-manipulation.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
“…have obligations in that we have a great deal of power over how people ultimately make use of data, both in the patterns they see and the conclusions they draw.”
<footer>
— Michael Correll, Ethical Dimensions of Visualization Research
</footer>
</blockquote>
<blockquote>
“Clutter and confusion are not attributes of data - they are shortcomings of design.”
<footer>
— Edward Tufte
</footer>
</blockquote>
<blockquote>
“Scientific visualization is classically defined as the process of graphically displaying scientific data. However, this process is far from direct or automatic. There are so many different ways to represent the same data: scatter plots, linear plots, bar plots, and pie charts, to name just a few. Furthermore, the same data, using the same type of plot, may be perceived very differently depending on who is looking at the figure. A more accurate definition for scientific visualization would be a graphical interface between people and data.”
<footer>
— Nicolas P. Rougier, Michael Droettboom, Philip E. Bourne, Ten Simple Rules for Better Figures
</footer>
</blockquote>
<blockquote>
“message and readability of the figure is the most important aspect while beauty is only an option”
<footer>
— Nicolas P. Rougier, Michael Droettboom, Philip E. Bourne, Ten Simple Rules for Better Figures
</footer>
</blockquote>
<div id="exploratory-plots-for-your-own-purposes" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Exploratory plots (for your own purposes)<a href="data-wrangling-and-manipulation.html#exploratory-plots-for-your-own-purposes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Exploratory plots are just <em>for you</em>, they focus solely on data exploration. They</p>
<ol style="list-style-type: decimal">
<li><strong>Don’t Have to Look Pretty:</strong> These plots are only needed to reveal insights.</li>
<li><strong>Just Needs to Get to the Point:</strong> Keep the plots concise and straightforward. Avoid unnecessary embellishments or complex formatting.</li>
<li><strong>Explore and Discover New Data Facets:</strong> Use exploratory plots to uncover hidden patterns, trends, or outliers in the data. Employ different plot types to reveal various facets and aspects of the dataset.</li>
<li><strong>Help Formulate New Questions:</strong> Use exploratory plots as a tool to prompt new questions and hypotheses. As you discover patterns, think about what additional questions these findings raise for further investigation.</li>
</ol>
<p>Let’s use a base <code>R</code> command (i.e., functions shipped with <code>R</code>) to create a <code>boxplot</code> of our <code>paua</code> data.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data-wrangling-and-manipulation.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Age <span class="sc">~</span> Species, <span class="at">data  =</span> paua)</span></code></pre></div>
<p><img src="_main_files/figure-html/boxplot-1.png" width="672" /></p>
<p>So what have we asked our computer to do here? We are using the function <code>boxplot()</code> and supplying two arguments: <code>Age ~ Species</code>, and <code>data  = paua</code>. The first argument <code>Age ~ Species</code> is how <code>R</code> understands equations (e.g., <span class="math inline">\(y = x\)</span>) and is asking for the variable <code>Age</code> to be plotted by the variable <code>Species</code>. The second argument <code>data = paua</code> specifies from which data object to grab the variables from (in this case the <code>paua</code> object we created above).</p>
<div class="alert alert-warning">
<p><strong>TASK</strong> Run each line of the following code and comment briefly on what each plot shows.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-wrangling-and-manipulation.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Length <span class="sc">~</span> Species, <span class="at">data  =</span> paua)</span>
<span id="cb31-2"><a href="data-wrangling-and-manipulation.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Age <span class="sc">~</span> Species, <span class="at">data  =</span> paua)</span>
<span id="cb31-3"><a href="data-wrangling-and-manipulation.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Age <span class="sc">~</span> Length, <span class="at">data  =</span> paua)</span>
<span id="cb31-4"><a href="data-wrangling-and-manipulation.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Age <span class="sc">~</span> Length, <span class="at">data  =</span> paua)</span>
<span id="cb31-5"><a href="data-wrangling-and-manipulation.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(paua<span class="sc">$</span>Age)</span></code></pre></div>
</div>
</div>
<div id="explanatory-plots" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Explanatory plots<a href="data-wrangling-and-manipulation.html#explanatory-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Explanatory plots are mainly <em>for others</em>. These are the most common kind of graph used in scientific publications. They should</p>
<ol style="list-style-type: decimal">
<li><strong>Have a Clear Purpose:</strong> Define a clear and specific purpose for your plot. Identify what scientific question or hypothesis the plot is addressing. Avoid unnecessary elements that do not contribute to this purpose.</li>
<li><strong>Be Designed for the Audience:</strong> Tailor the design of your plot to the characteristics and expertise of your audience. Consider their familiarity with technical terms, preferred visualizations, and overall scientific background.</li>
<li><strong>Be Easy to Read:</strong> Prioritize readability by using legible fonts, appropriate font sizes, and clear labels. Ensure that the axes are well-labeled, and use a simple and straightforward layout. Avoid clutter and unnecessary complexity that could hinder comprehension.</li>
<li><strong>Not Distort the Data:</strong> Maintain the integrity of the data by avoiding distortion in your plot. Ensure that scales and proportions accurately represent the underlying data, preventing misleading visualizations.</li>
<li><strong>Help Guide the Reader to a Particular Conclusion:</strong>
Structure your plot in a way that guides the reader toward the intended conclusion. Use visual elements such as annotations, arrows, or emphasis to highlight key findings and lead the reader through the data interpretation process.</li>
<li><strong>Answer a Specific Question:</strong>Construct your plot with a specific research question in mind. The plot should directly address and answer this question, providing a clear and unambiguous response.</li>
<li><strong>Support an Outlined Decision:</strong> If the plot is intended to support decision-making, clearly outline the decision or action it is meant to inform. The plot should provide relevant information that aids in making well-informed decisions based on the presented data.</li>
</ol>
<p align="center">
<img src="https://jimgruman.netlify.app/post/variableimportance/2020_31_PalmerPenguins.png" />
</p>
<p align="center">
Plots by Cedric Scherer and mentioned on <a href="https://jimgruman.netlify.app/post/variableimportance/">this blog</a>
</p>
<p>The table below summarises <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833">Ten Simple Rules for Better Figures</a>, a basic set of rules to improve your visualizations.</p>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th>Rule Name</th>
<th>Rule Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Know Your Audience</strong></td>
<td>Understand the characteristics and expertise of your audience to tailor the figure accordingly.</td>
</tr>
<tr class="even">
<td><strong>Identify Your Message</strong></td>
<td>Clearly define the main message or takeaway that you want the audience to understand from the figure.</td>
</tr>
<tr class="odd">
<td><strong>Adapt the Figure to the Support Medium</strong></td>
<td>Tailor the figure’s complexity and design to suit the medium it will be presented in (e.g., print, online).</td>
</tr>
<tr class="even">
<td><strong>Captions Are Not Optional</strong></td>
<td>Craft informative captions that provide essential details and context for interpreting the figure.</td>
</tr>
<tr class="odd">
<td><strong>Do Not Trust the Defaults</strong></td>
<td>Adjust default settings to optimize the visual elements of the figure, such as colors, scales, and labels.</td>
</tr>
<tr class="even">
<td><strong>Use Color Effectively</strong></td>
<td>Apply color purposefully, taking into account accessibility considerations and cultural interpretations.</td>
</tr>
<tr class="odd">
<td><strong>Do Not Mislead the Reader</strong></td>
<td>Avoid creating misleading visualizations and be aware of formulas to measure the potential misleading nature of a graph. <a href="https://en.wikipedia.org/wiki/Misleading_graph">There are formulas to measure how misleading a graph is!</a></td>
</tr>
<tr class="even">
<td><strong>Avoid Chartjunk</strong></td>
<td>Eliminate unnecessary decorations and embellishments in the figure that do not contribute to the message.</td>
</tr>
<tr class="odd">
<td><strong>Message Trumps Beauty</strong></td>
<td>Prioritize conveying a clear message over making the figure aesthetically pleasing.</td>
</tr>
<tr class="even">
<td><strong>Get the Right Tool</strong></td>
<td>Choose the appropriate visualization tool (e.g., <code>R</code>) or chart type that best communicates the data and intended message.</td>
</tr>
</tbody>
</table>
<div class="alert alert-warning">
<p><strong>TASK</strong> Read <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833">this short paper</a> and find examples in your choice of literature of one or more of the rules in action.</p>
</div>
</div>
</div>
<div id="plotting-using-ggplot2" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Plotting using <code>ggplot2</code><a href="data-wrangling-and-manipulation.html#plotting-using-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code> is an <code>R</code> package for producing statistical, or data, graphics; it has an underlying grammar based on the <a href="https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448">Grammar of Graphics</a></p>
<center>
<img src="figs/ggplot.png" />
</center>
<p>Every <code>ggplot2</code> plot has three <strong>key</strong> components:</p>
<ul>
<li><p><code>data</code>,</p></li>
<li><p>A set of <code>aes</code>thetic mappings between variables in the data and visual properties, and</p></li>
<li><p>At least one layer which describes how to render each observation. Layers are usually created with a <code>geom_*</code> function.</p></li>
</ul>
<p>Every plot created using <code>ggplot2</code> code requires the three components above:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-wrangling-and-manipulation.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="do">## load package</span></span>
<span id="cb32-2"><a href="data-wrangling-and-manipulation.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>your_data<span class="sc">&gt;</span>, <span class="fu">aes</span>(<span class="sc">&lt;</span>specify_aesthetics<span class="sc">&gt;</span>)) <span class="sc">+</span> <span class="do">## initialize plot specifying data and aesthetics</span></span>
<span id="cb32-3"><a href="data-wrangling-and-manipulation.html#cb32-3" aria-hidden="true" tabindex="-1"></a>    geom_<span class="sc">&lt;</span>specify_geom<span class="sc">&gt;</span>() <span class="do">## add a layer (or geom)</span></span></code></pre></div>
<p><strong>Note</strong> the <code>+</code> operator used to add a layer onto a <code>ggplot</code> object (see below for examples), it has a specific purpose in a <code>ggplot2</code> context. It should not be confused with the pipe operator <code>%&gt;%</code> which takes the output of one function and passes it as the first argument to the next function (see <a href="data-wrangling-and-manipulation.html#the-pipe-operator">The pipe operator</a>).</p>
<p>The table below summaries the most common <code>geom</code>s and gives examples of when they are most likely appropriate.</p>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="43%" />
<col width="26%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th><code>geom_*</code></th>
<th>Description</th>
<th>Typical Use Case</th>
<th>Mapping Aesthetics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>geom_point</code></td>
<td>Displays individual data points as dots on the plot.</td>
<td>Visualizing individual data points in a scatter plot.</td>
<td><code>aes(x = ..., y = ...)</code>: X and Y coordinates.</td>
</tr>
<tr class="even">
<td><code>geom_line</code></td>
<td>Connects data points with lines, useful for showing trends or relationships between continuous variables.</td>
<td>Representing trends or relationships over continuous variables.</td>
<td><code>aes(x = ..., y = ...)</code>: X and Y coordinates.</td>
</tr>
<tr class="odd">
<td><code>geom_bar</code></td>
<td>Creates bar charts, displaying the frequency or count of data within categorical groups.</td>
<td>Illustrating the distribution of categorical data.</td>
<td><code>aes(x = ..., y = ...)</code>: X-axis (categorical) and Y-axis (count or frequency).</td>
</tr>
<tr class="even">
<td><code>geom_histogram</code></td>
<td>Constructs histograms, visualizing the distribution of continuous variables by dividing them into bins.</td>
<td>Examining the distribution of a single continuous variable.</td>
<td><code>aes(x = ..., y = ...)</code>: X-axis (continuous) and Y-axis (count or frequency).</td>
</tr>
<tr class="odd">
<td><code>geom_boxplot</code></td>
<td>Generates box plots, illustrating the distribution of a continuous variable and highlighting outliers.</td>
<td>Summarizing the distribution of continuous variables.</td>
<td><code>aes(x = ..., y = ...)</code>: X-axis (categorical) and Y-axis (continuous).</td>
</tr>
<tr class="even">
<td><code>geom_area</code></td>
<td>Fills the area between a line and the x-axis, useful for visualizing accumulated quantities or proportions.</td>
<td>Depicting cumulative or proportional relationships.</td>
<td><code>aes(x = ..., y = ...)</code>: X and Y coordinates.</td>
</tr>
<tr class="odd">
<td><code>geom_text</code></td>
<td>Adds text labels to the plot, providing additional information about specific data points.</td>
<td>Annotating specific points or adding labels to the plot.</td>
<td><code>aes(x = ..., y = ..., label = ...)</code>: X, Y coordinates, and text labels.</td>
</tr>
<tr class="even">
<td><code>geom_smooth</code></td>
<td>Fits and overlays a smoothed line (e.g., LOESS or linear regression) on the data points.</td>
<td>Highlighting trends and capturing patterns in the data.</td>
<td><code>aes(x = ..., y = ...)</code>: X and Y coordinates.</td>
</tr>
<tr class="odd">
<td><code>geom_violin</code></td>
<td>Produces violin plots, displaying the distribution of a continuous variable across different categories.</td>
<td>Visualizing the distribution and density of data within categories.</td>
<td><code>aes(x = ..., y = ...)</code>: X-axis (categorical) and Y-axis (continuous).</td>
</tr>
<tr class="even">
<td><code>geom_segment</code></td>
<td>Draws line segments between specified points, useful for indicating relationships or connections in the data.</td>
<td>Illustrating relationships between two sets of coordinates.</td>
<td><code>aes(x = ..., y = ..., xend = ..., yend = ...)</code>: Start and end coordinates for the segments.</td>
</tr>
</tbody>
</table>
<div id="plotting-the-palmerpenguins-data" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Plotting the <code>palmerpenguins</code> data<a href="data-wrangling-and-manipulation.html#plotting-the-palmerpenguins-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>You might find <a href="https://cmjt.shinyapps.io/penguin/">this application</a> useful</strong></p>
<p>Recall we used specified an <code>NA</code>-free version of the dataset:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data-wrangling-and-manipulation.html#cb33-1" aria-hidden="true" tabindex="-1"></a>penguins_nafree <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="data-wrangling-and-manipulation.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code></pre></div>
<p>First off, let’s create a <strong>scatter plot</strong>. The code below takes the <code>penguins_nafree</code> dataset (created above) and maps the body mass variable <code>body_mass_g</code> to the x-axis and flipper length variable <code>flipper_length_mm</code> to the y-axis. Then, it adds points to the plot to represent each data point in the dataset. Therefore, the plot shows the relationship between body mass (g) and flipper length (mm) for the penguins in our dataset <code>penguins_nafree</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-wrangling-and-manipulation.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree,<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span> <span class="do">## data &amp; aesthetics</span></span>
<span id="cb34-2"><a href="data-wrangling-and-manipulation.html#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="do">## geom</span></span></code></pre></div>
<p><img src="_main_files/figure-html/flippoint-1.png" width="672" /></p>
<p>Breaking the code above down we have</p>
<ol style="list-style-type: decimal">
<li><code>ggplot(penguins_nafree, aes(x = body_mass_g, y = flipper_length_mm))</code> initializes the plot using the <code>ggplot()</code> function. It specifies the data frame <code>penguins_nafree</code> and the aesthetics mapping: setting the x-axis (<code>x</code>) to the <code>body_mass_g</code> variable and the y-axis (<code>y</code>) to the <code>flipper_length_mm</code> variable.</li>
<li>We then add (using the <code>+</code> operator) a layer to the plot using <code>geom_point()</code>, which specifies that the data points should be represented as points on the plot. Each point corresponds to a row in the dataset, with <code>x</code> and <code>y</code> coordinates determined by the aesthetics specified in the previous line.</li>
</ol>
<p>But, what about adding some personal touches? We can add more appropriate axis labels can be specified using <code>xlab()</code> and <code>ylab()</code> and even customizes the color scale using <code>scale_color_manual()</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data-wrangling-and-manipulation.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins_nafree, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="data-wrangling-and-manipulation.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> species),<span class="at">size =</span> <span class="dv">2</span>)  <span class="sc">+</span></span>
<span id="cb35-3"><a href="data-wrangling-and-manipulation.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkorchid&quot;</span>,<span class="st">&quot;cyan4&quot;</span>), <span class="at">name =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="data-wrangling-and-manipulation.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Bill length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="data-wrangling-and-manipulation.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Bill depth (mm)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/point-1.png" width="672" /></p>
<p>Breaking down the lines of code here we have that</p>
<ol style="list-style-type: decimal">
<li>Again <code>ggplot(penguins_nafree, aes(x = body_mass_g, y = flipper_length_mm))</code> initializes the plot using the <code>ggplot()</code> function. It specifies the data frame <code>penguins_nafree</code> and the aesthetics mapping: setting the x-axis (<code>x</code>) to the <code>body_mass_g</code> variable and the y-axis (<code>y</code>) to the <code>flipper_length_mm</code> variable.</li>
<li><code>geom_point(aes(color = species), size = 2)</code> adds a layer to the plot using <code>geom_point()</code>. It specifies that the data points should be represented as points on the plot. The argument <code>aes(color = species)</code> argument the species variable to the color of the points, and <code>size = 2</code> sets the size of the points.</li>
<li><code>scale_color_manual(values = c("darkorange","darkorchid","cyan4"), name = "")</code> customizes the color scale of the points by setting the manually via the argument <code>values = c("darkorange","darkorchid","cyan4")</code>. Here the three specified colors are used for the three different species of penguins passed on from the previous aesthetic. The argument <code>name = ""</code> removes the legend title.</li>
<li>Finally <code>xlab("Bill length (mm)")</code> and <code>ylab("Bill depth (mm)")</code> manually set the x-axis and y-axis labels.</li>
</ol>
<div class="alert alert-warning">
<strong>TASK</strong>Try specifying some different colours in <code>scale_color_manual()</code> in the code above. Research Hex colour codes and try using these instead of colour names.
</div>
<p>Now let’s move onto plotting different types of data (e.g., continuous and discrete) on the same plot. We can even add some easy custom themeing using in-built <code>ggplot2</code> functionality (e.g., <code>theme_classic()</code>). The code below, generates a boxplot that compares the distribution of flipper lengths (mm) for the different penguin species.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data-wrangling-and-manipulation.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## boxplot</span></span>
<span id="cb36-2"><a href="data-wrangling-and-manipulation.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="data-wrangling-and-manipulation.html#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="data-wrangling-and-manipulation.html#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Flipper length (mm)&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="data-wrangling-and-manipulation.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Breaking the code above down we have</p>
<ol style="list-style-type: decimal">
<li><code>ggplot(penguins_nafree, aes(x = species, y = flipper_length_mm))</code> initializes the plot using the <code>ggplot()</code> function. It uses the <code>penguins_nafree</code> dataset and sets the x-axis (x) to the <code>species</code> variable and the y-axis (y) to the <code>flipper_length_mm</code> variable.</li>
<li><code>geom_boxplot()</code> adds a layer to the plot creating boxplots for each level of the <code>species</code> (x-axis) variable (species).</li>
<li><code>ylab("Flipper length (mm)") + xlab("")</code> manually set the y-axis label to <code>"Flipper length (mm)"</code> and remove the x-axis label (setting it to an empty string <code>""</code>).</li>
<li><code>theme_classic()</code> applies the so called <em>classic</em> theme to the plot, changing the appearance of the background and gridlines etc. from the default ones above.</li>
</ol>
<div class="alert alert-warning">
<p><strong>TASK</strong>
Type <code>theme_</code> into your Console and wait for <code>RStudio</code> to attempt to autocomplete for you. Run down the list of in-built themes and try them instead of <code>theme_classic()</code> above.</p>
</div>
<p>Rather than a boxplot we are going to create a violin plot of the same variables using <code>geom_violin()</code> (we use another theme this time <code>theme_minimal()</code>). Violin plots are more flexible than boxplots as they better show the shape (i.e., distribution) of our data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-wrangling-and-manipulation.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## violin plot</span></span>
<span id="cb37-2"><a href="data-wrangling-and-manipulation.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span> </span>
<span id="cb37-3"><a href="data-wrangling-and-manipulation.html#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="data-wrangling-and-manipulation.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Flipper length (mm)&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="data-wrangling-and-manipulation.html#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="do">## another theme...</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="alert alert-warning">
<p><strong>TASK</strong> What can you say about the distribution of penguin flipper length. Do you this the distributions are symmetrical, skewed, bimodal?</p>
</div>
<p>The code below plots a histogram of flipper lengths (mm) for penguins, with different colors representing different species. We make the colours transparent using the <code>alpha</code> argument so that we can see the overlap in distributions. There are also another couple of new functions and arguments used, breaking the code down line by line we have</p>
<ol style="list-style-type: decimal">
<li><code>ggplot(penguins_nafree, aes(x = flipper_length_mm))</code> initializes the plot using the <code>ggplot()</code> function. We specify the <code>penguins_nafree</code> dataset and map the x-axis (x) to the <code>flipper_length_mm</code> variable.</li>
<li><code>geom_histogram(aes(fill = species), alpha = 0.5, position = "identity")</code> adds a layer to the plot using <code>geom_histogram()</code>, which creates a histogram of flipper lengths. The <code>aes(fill = species)</code> argument colors the bars based on the <code>species</code> variable. Setting <code>alpha = 0.5</code> adjusts the transparency (which ranges from 0 to 1) of the bars. Finally, the less obvious use of and <code>position = "identity"</code> places the bars directly adjacent to each other.</li>
<li><code>xlab("Flipper length (mm)")</code> sets the x-axis label.</li>
<li><code>scale_fill_brewer(palette = "Dark2", name = "Species")</code> specifies a custom color scale mapped to the fill aesthetic. It sets the color palette to <code>"Dark2"</code> and assigns the legend title as <code>"Species"</code>.</li>
<li><code>theme_light()</code> sets another in-built theme changing the appearance of the background and gridlines etc.</li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data-wrangling-and-manipulation.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## histogram, with a colorblind friendly palette</span></span>
<span id="cb38-2"><a href="data-wrangling-and-manipulation.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree,<span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm)) <span class="sc">+</span> </span>
<span id="cb38-3"><a href="data-wrangling-and-manipulation.html#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> species), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="data-wrangling-and-manipulation.html#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Flipper length (mm)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="data-wrangling-and-manipulation.html#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="data-wrangling-and-manipulation.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="do">## and another theme....</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="alert alert-warning">
<p><strong>TASK</strong>
We should always avoid using similarly bight red and green colours: they may not be distinguishable for red-green colorblind readers. Using <code>ggplot2</code> we can access a whole range of colourblind friendly palettes: one package that has a whole range is <code>RColorBrewer</code> install it then try running <code>RColorBrewer::display.brewer.all(colorblindFriendly = TRUE)</code> what do you think you’ve asked your computer to show you?</p>
</div>
<p>We’ve seen that there are three <code>factor</code> variables in the dataset: <code>species</code>, <code>island</code>, and <code>sex</code>. To count the number of penguins of each <code>species</code> and <code>sex</code> on each <code>island</code> we could use the following pipeline.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-wrangling-and-manipulation.html#cb39-1" aria-hidden="true" tabindex="-1"></a>penguins_nafree <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="data-wrangling-and-manipulation.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species, sex, island)</span>
<span id="cb39-3"><a href="data-wrangling-and-manipulation.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 10 × 4</span></span>
<span id="cb39-4"><a href="data-wrangling-and-manipulation.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    species   sex    island        n</span></span>
<span id="cb39-5"><a href="data-wrangling-and-manipulation.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;     &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;</span></span>
<span id="cb39-6"><a href="data-wrangling-and-manipulation.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Adelie    female Biscoe       22</span></span>
<span id="cb39-7"><a href="data-wrangling-and-manipulation.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Adelie    female Dream        27</span></span>
<span id="cb39-8"><a href="data-wrangling-and-manipulation.html#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Adelie    female Torgersen    24</span></span>
<span id="cb39-9"><a href="data-wrangling-and-manipulation.html#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Adelie    male   Biscoe       22</span></span>
<span id="cb39-10"><a href="data-wrangling-and-manipulation.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Adelie    male   Dream        28</span></span>
<span id="cb39-11"><a href="data-wrangling-and-manipulation.html#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Adelie    male   Torgersen    23</span></span>
<span id="cb39-12"><a href="data-wrangling-and-manipulation.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Chinstrap female Dream        34</span></span>
<span id="cb39-13"><a href="data-wrangling-and-manipulation.html#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Chinstrap male   Dream        34</span></span>
<span id="cb39-14"><a href="data-wrangling-and-manipulation.html#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Gentoo    female Biscoe       58</span></span>
<span id="cb39-15"><a href="data-wrangling-and-manipulation.html#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Gentoo    male   Biscoe       61</span></span></code></pre></div>
<p>However, it’s not too easy to compare the raw numbers here; so what about a bar graph?</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="data-wrangling-and-manipulation.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="data-wrangling-and-manipulation.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="data-wrangling-and-manipulation.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>island) <span class="sc">+</span> <span class="do">## what are we doing here?</span></span>
<span id="cb40-4"><a href="data-wrangling-and-manipulation.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="data-wrangling-and-manipulation.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span> <span class="do">## remember themes...</span></span>
<span id="cb40-6"><a href="data-wrangling-and-manipulation.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;cyan4&quot;</span>,<span class="st">&quot;darkorange&quot;</span>), <span class="at">name =</span> <span class="st">&quot;Sex&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/bar-1.png" width="672" /></p>
<div class="alert alert-warning">
<p><strong>TASK</strong> Before reading the breakdown below write out your own and then compare the two.</p>
</div>
<p>Breaking down the code above we have</p>
<ol style="list-style-type: decimal">
<li><code>ggplot(penguins_nafree, aes(x = species, fill = sex))</code> initializes the plot using the <code>ggplot()</code> function, specifying the dataset <code>penguins_nafree</code>. It maps the x-axis (x) to the <code>species</code> variable and fills the bars based on the <code>sex</code> variable.</li>
<li><code>geom_bar(alpha = 0.8, position = "dodge")</code> adds a layer to the plot using <code>geom_bar()</code>. The <code>alpha = 0.8</code> argument adjusts the transparency of the bars, and <code>position = "dodge"</code> places the bars side by side for each species.</li>
<li><code>facet_wrap(~island)</code> creates a faceted plot where separate plots are generated for each level of the <code>island</code> variable.</li>
<li><code>xlab("")</code> sets the x-axis label as an empty string <code>""</code>.</li>
<li><code>theme_linedraw()</code> applies a linedraw theme to the plot.</li>
<li><code>scale_fill_manual(values = c("cyan4", "darkorange"), name = "Sex")</code>customizes the fill color scale and sets the colors for the two levels of the <code>sex</code> variable assigning the legend title as <code>"Sex"</code>.</li>
</ol>
<div class="alert alert-warning">
<p><strong>TASK</strong> Run each code chunk below. Map each line to a component in the plot produced. Can you improve the plots?</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-wrangling-and-manipulation.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span> <span class="do">## data &amp; aesthetics</span></span>
<span id="cb41-2"><a href="data-wrangling-and-manipulation.html#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()  <span class="sc">+</span> <span class="do">## geom</span></span>
<span id="cb41-3"><a href="data-wrangling-and-manipulation.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Flipper length (mm) by species&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="data-wrangling-and-manipulation.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Flipper length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="data-wrangling-and-manipulation.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="data-wrangling-and-manipulation.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>() <span class="do">## theme</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data-wrangling-and-manipulation.html#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="data-wrangling-and-manipulation.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span> <span class="do">## data &amp; aesthetics</span></span>
<span id="cb42-3"><a href="data-wrangling-and-manipulation.html#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>()  <span class="sc">+</span> <span class="do">## geom</span></span>
<span id="cb42-4"><a href="data-wrangling-and-manipulation.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Flipper length (mm) by species&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="data-wrangling-and-manipulation.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Flipper length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="data-wrangling-and-manipulation.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="data-wrangling-and-manipulation.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>() <span class="do">## theme</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-wrangling-and-manipulation.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span> <span class="do">## data &amp; aesthetics</span></span>
<span id="cb43-2"><a href="data-wrangling-and-manipulation.html#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>()  <span class="sc">+</span> <span class="do">## geom</span></span>
<span id="cb43-3"><a href="data-wrangling-and-manipulation.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Flipper length (mm) by species&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="data-wrangling-and-manipulation.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Flipper length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="data-wrangling-and-manipulation.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="data-wrangling-and-manipulation.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>() <span class="do">## theme</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="data-wrangling-and-manipulation.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_nafree, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm, </span>
<span id="cb44-2"><a href="data-wrangling-and-manipulation.html#cb44-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col =</span> species)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="data-wrangling-and-manipulation.html#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="data-wrangling-and-manipulation.html#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="data-wrangling-and-manipulation.html#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span> sex) <span class="sc">+</span></span>
<span id="cb44-6"><a href="data-wrangling-and-manipulation.html#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb44-7"><a href="data-wrangling-and-manipulation.html#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Flipper Length and Body Mass, by Sex &amp; Species&quot;</span>,</span>
<span id="cb44-8"><a href="data-wrangling-and-manipulation.html#cb44-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="fu">nrow</span>(penguins), <span class="st">&quot; of the Palmer Penguins&quot;</span>),</span>
<span id="cb44-9"><a href="data-wrangling-and-manipulation.html#cb44-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Body Mass (g)&quot;</span>, </span>
<span id="cb44-10"><a href="data-wrangling-and-manipulation.html#cb44-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Flipper Length (mm)&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="bringing-things-together" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Bringing things together<a href="data-wrangling-and-manipulation.html#bringing-things-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="more-on-pipelines-and-operators" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> More on pipelines and operators<a href="data-wrangling-and-manipulation.html#more-on-pipelines-and-operators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this chapter you’ve been introduced to the pipe operator <code>%&gt;%</code> and the use of the <code>+</code> operator adding layers to a <code>ggplot</code>. Recall that <code>%&gt;%</code> is used for chaining operations in a data manipulation pipeline, whilst <code>+</code> is used for adding layers to a plot in the <code>ggplot2</code> framework. They serve different purposes, but we can combine them! For example, we can pipe a data object using <code>%&gt;%</code> into a ggplot workflow and then use <code>+</code> to add layers.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-wrangling-and-manipulation.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb45-2"><a href="data-wrangling-and-manipulation.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb45-3"><a href="data-wrangling-and-manipulation.html#cb45-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="data-wrangling-and-manipulation.html#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="data-wrangling-and-manipulation.html#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(., island <span class="sc">==</span> <span class="st">&quot;Biscoe&quot;</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="data-wrangling-and-manipulation.html#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">y =</span> body_mass_g, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb45-7"><a href="data-wrangling-and-manipulation.html#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb45-8"><a href="data-wrangling-and-manipulation.html#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Penguin Body Mass by Species on Biscoe&quot;</span>,</span>
<span id="cb45-9"><a href="data-wrangling-and-manipulation.html#cb45-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Body Mass (g)&quot;</span>, </span>
<span id="cb45-10"><a href="data-wrangling-and-manipulation.html#cb45-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="alert alert-warning">
<p><strong>TASK</strong> Run the code below. It will give you an error, can you figure out what the cause is?</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="data-wrangling-and-manipulation.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="data-wrangling-and-manipulation.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb46-3"><a href="data-wrangling-and-manipulation.html#cb46-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="data-wrangling-and-manipulation.html#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="data-wrangling-and-manipulation.html#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(., island <span class="sc">==</span> <span class="st">&quot;Biscoe&quot;</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="data-wrangling-and-manipulation.html#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">y =</span> body_mass_g, <span class="at">x =</span> species)) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="data-wrangling-and-manipulation.html#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="data-wrangling-and-manipulation.html#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Penguin Body Mass by Species on Biscoe&quot;</span>,</span>
<span id="cb46-9"><a href="data-wrangling-and-manipulation.html#cb46-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Body Mass (g)&quot;</span>, </span>
<span id="cb46-10"><a href="data-wrangling-and-manipulation.html#cb46-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="what-to-look-at-in-a-plot-a-taster" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> What to look at in a plot (<em>a taster</em>)<a href="data-wrangling-and-manipulation.html#what-to-look-at-in-a-plot-a-taster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In many of the following chapters you will hear a lot about variability or variation. Variation is simply a measure of spread (i.e., how far apart the observations are from each other). In particular, we often talk about deviation from the mean (i.e., how far away from the average value the observations are) as we are often interested in how <em>large</em> this deviation is relative to the information we have. In <a href="Introduction%20to%20Hypothesis%20testing">Chapter 5</a> you will learn about ways of formally testing this. However, with the data visualization skills you’ve just learnt we can already begin to critically evaluate our data by simply looking at plots.</p>
<p><strong>Between-group variation</strong> is a measure of the variability between different groups; it assesses how much the means of different groups differ from each other. Higher between-group variation suggests that the groups are not similar. However, before we can conclude anything relating to similarity, or not, of groups we also have to consider within-group variation.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p><strong>Within group variation</strong> measures the variability among individual data points within each group; it measures how much individual data points within each group differ from the group’s mean. Lower within-group variation suggests that the data points within each group are less scattered around the group’s mean</p>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="alert alert-info" role="alert">
<p><img src="https://github.com/BIOSCI220/hoiho/blob/main/hoiho_hex.png?raw=true" style="width:10.0%" /></p>
<p><strong>Other resources: optional but recommended</strong></p>
<ul>
<li>
<a href="https://www.youtube.com/watch?v=W8rY-DNQI2Q">Ihaka Lecture Series 2023 Danielle Navarro – Unpredictable paintings: Making generative artwork in R</a>
</li>
<li>
<a href="https://www.youtube.com/watch?v=utUr1pV8Em4">Ihaka Lecture Series 2023 Chris McDowall – What’s Behind the Map: The Process of Data Visualisation</a>
</li>
<li>
<a href="https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf"><code>ggplot2</code> cheatsheet</a>
</li>
<li>
<a href="https://ggplot2-book.org/introduction.html">Elegant Graphics for Data Analysis</a>
</li>
<li>
<a href="https://ourcodingclub.github.io/tutorials/datavis/">Using <code>ggplot2</code> to communicate your results</a>
</li>
<li>
<a href="https://tinystats.github.io/teacups-giraffes-and-statistics/">Teacups, giraffes, and statistics: free online introductory level R and statistics modules</a>
</li>
</ul>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-and-rstudio-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ethical-data-practice.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
